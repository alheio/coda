PROJECT(coda)
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

INCLUDE_DIRECTORIES(.)
FIND_LIBRARY(EXPAT_LIBRARY NAMES expat PATHS /opt/lib /usr/lib /usr/local/lib)

ADD_LIBRARY(coda STATIC coda/txml.cpp)
TARGET_LINK_LIBRARIES(coda ${EXPAT_LIBRARY})
SET_TARGET_PROPERTIES(coda PROPERTIES VERSION 0.1 SOVERSION 1)

INSTALL(FILES coda/txml.hpp DESTINATION include/coda)

IF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64")
	INSTALL(TARGETS coda DESTINATION lib64)
ELSE(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64")
	INSTALL(TARGETS coda DESTINATION lib)
ENDIF(${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64")

ENABLE_TESTING()
ADD_EXECUTABLE(test_txml tests/txml/test_txml.cpp)
TARGET_LINK_LIBRARIES(test_txml coda)
ADD_TEST(test_txml test_txml)

